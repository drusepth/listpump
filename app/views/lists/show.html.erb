<h1>
  <%= @list.name %>
  <%= link_to 'Edit', edit_list_path(@list), class: 'btn' %>
  <%# link_to 'Add Person Manually', new_person_path(list_id: @list.id), class: 'btn' %>
</h1>

<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Medium</th>
      <th>Triggered phrases</th>
      <th>Metadata</th>
      <th colspan="2"></th>
    </tr>
  </thead>

  <tbody>
    <% @people.order(:name).each do |person| %>
      <tr>
        <td><%= link_to person.name, person %></td>
        <td><%= person.medium %></td>
        <td>
          <ul>
            <% person.list_inclusions.each do |list_inclusion| %>
              <li>
                <%= list_inclusion.matched_text %>
                (<%= link_to list_inclusion.trigger.name, list_inclusion.trigger %>)
              </li>
            <% end %>
          </ul>
        </td>
        <td>on <%= pluralize person.list_inclusions.count, 'list' %></td>
        <td><%= link_to 'Edit', edit_person_path(person) %></td>
        <td><%= link_to 'Destroy', person, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<h1>
  Triggers
  <%= link_to 'Add', new_trigger_path(list_id: @list.id), class: "btn #{'btn-primary' if @triggers.empty?}" %>
</h1>

<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Search Query</th>
      <th>Match Pattern</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @triggers.order(:name).each do |trigger| %>
      <tr>
        <td><%= trigger.name %></td>
        <td><%= trigger.search_query %></td>
        <td>/<%= trigger.pattern %>/</td>
        <td><%= link_to 'Edit', edit_trigger_path(trigger) %></td>
        <td><%= link_to 'Destroy', trigger, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

